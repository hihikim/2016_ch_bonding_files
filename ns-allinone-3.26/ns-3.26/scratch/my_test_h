#ifndef MY_TEST__H
#define MY_TEST__H
#define CHAR_MAX_LENGTH 1024

#include "ns3/core-module.h"
#include "ns3/network-module.h"
#include "ns3/applications-module.h"
#include "ns3/wifi-module.h"
#include "ns3/mobility-module.h"
#include "ns3/ipv4-global-routing-helper.h"
#include "ns3/internet-module.h"

#include <iostream>
#include <fstream>
#include <vector>
#include <sstream>

using namespace std;

struct InApInfo    //input information of ap
{
	double x;  //position x
	double y;  //position y
	uint16_t channel; //allocated channel
	uint32_t width;   //width   1~8
};
struct InStaInfo   //input information of station
{
	double x;  //position x
	double y;  //position y
	uint16_t traffic_demand; //traffic demand
};

struct OutApInfo    //output information of ap
{
	double avg_throughput; //average throughput
	double min_throughput;
	double max_throughput;
	vector<double> tx_idle_ratio;
};

struct OutStaInfo   //output information of station
{
	double avg_throughput;
	double min_throughput;
	double max_throughput;
	vector<double> served_demand_ratio;
};


class Parser
{
public:
	Parser();
	~Parser();
	InApInfo GetApInfo(uint32_t index);
	InStaInfo GetStaInfo(uint32_t index);
	void SetupInputFile(string path, bool ap_sta);  //ap_sta: ap(true) sta(false)
	void Parse();
	void CloseFile();
	void Clean();
	map<unsigned int, InApInfo>::iterator GetApBegin();
	map<unsigned int, InStaInfo>::iterator GetStaBegin();
	map<unsigned int, InApInfo>::iterator GetApEnd();
	map<unsigned int, InStaInfo>::iterator GetStaEnd();

private:
	ifstream* input_file;
	map<unsigned int, InApInfo> ap_info;
	map<unsigned int, InStaInfo> sta_info;
	bool is_ap;
};

class OutputGenerator
{
public:
	OutputGenerator();
	~OutputGenerator();
	void Clean();
	void Print();
	void SetupOutPutFile(string path);
	void RecordData();

private:
	ofstream output_file;
	map<uint32_t,OutStaInfo> sta_info;
	map<uint32_t,OutApInfo> ap_info;
};


#endif
